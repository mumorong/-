<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>ê³¼ìˆ˜ ê´€ë¦¬ ì•±</title>
  <style>
    body { font-family: 'Arial'; margin: 0; padding: 10px; max-width: 390px; background: #f5f5f5; }
    input, select, button { font-size: 16px; margin: 5px 0; width: 100%; padding: 8px; box-sizing: border-box; }
    table { width: 100%; border-collapse: collapse; margin: 10px 0; background: white; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
    th { background: #eee; }
    .btn { padding: 8px; margin-top: 5px; cursor: pointer; font-weight: bold; }
    .btn-danger { background: #ff6666; color: white; border: none; }
  </style>
</head>
<body>

  <h2>ğŸ“‹ í’ˆì¢… ë°ì´í„° ì…ë ¥</h2>
  <input type="text" id="hiroshi" placeholder="íˆë¡œì‹œ (ì˜ˆ: H01)" />
  <input type="text" id="name" placeholder="ì´ë¦„" />
  <input type="text" id="fruit" placeholder="ê³¼ìˆ˜ (ì˜ˆ: 14ë‚´)" />
  <input type="number" id="count" placeholder="ê°œìˆ˜" />
  <button onclick="addEntry()" class="btn">ì¶”ê°€</button>

  <h2>ğŸ” í•„í„°</h2>
  <select id="filterHiroshi" onchange="filterData()"></select>
  <select id="filterFruit" onchange="filterData()"></select>

  <h2>ğŸ“Š ì…ë ¥ ë°ì´í„°</h2>
  <div id="totalCount">ì´ ê°¯ìˆ˜: 0</div>
  <table id="dataTable">
    <thead>
      <tr>
        <th>íˆë¡œì‹œ</th>
        <th>ì´ë¦„</th>
        <th>ê³¼ìˆ˜</th>
        <th>ê°œìˆ˜</th>
        <th>ì‚­ì œ</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>ğŸ¯ ëª©í‘œí‘œ</h2>
  <table id="goalTable">
    <thead>
      <tr>
        <th>íˆë¡œì‹œ</th>
        <th>ê³¼ìˆ˜</th>
        <th>ëª©í‘œ</th>
        <th>ì‹¤ì œ</th>
        <th>ìƒíƒœ</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    let dataList = [];
    let goalList = [
      { hiroshi: "H01", fruit: "14ë‚´", goal: 10 },
      { hiroshi: "H02", fruit: "16ë‚´", goal: 10 }
    ];

    function addEntry() {
      const hiroshi = document.getElementById("hiroshi").value.trim();
      const name = document.getElementById("name").value.trim();
      const fruit = document.getElementById("fruit").value.trim();
      const count = parseInt(document.getElementById("count").value);

      if (!hiroshi || !name || !fruit || isNaN(count)) {
        alert("ëª¨ë“  ì¹¸ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•˜ì„¸ìš”");
        return;
      }

      dataList.push({ hiroshi, name, fruit, count });
      document.getElementById("hiroshi").value = "";
      document.getElementById("name").value = "";
      document.getElementById("fruit").value = "";
      document.getElementById("count").value = "";

      updateTable();
    }

    function deleteEntry(index) {
      dataList.splice(index, 1);
      updateTable();
    }

    function updateTable() {
      const tbody = document.querySelector("#dataTable tbody");
      tbody.innerHTML = "";
      let total = 0;

      dataList.forEach((item, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${item.hiroshi}</td>
          <td>${item.name}</td>
          <td>${item.fruit}</td>
          <td>${item.count}</td>
          <td><button class="btn btn-danger" onclick="deleteEntry(${index})">ì‚­ì œ</button></td>
        `;
        tbody.appendChild(row);
        total += item.count;
      });

      document.getElementById("totalCount").textContent = "ì´ ê°¯ìˆ˜: " + total;
      updateFilters();
      updateGoalTable();
    }

    function updateFilters() {
      const hSet = new Set(dataList.map(d => d.hiroshi));
      const fSet = new Set(dataList.map(d => d.fruit));

      const hSelect = document.getElementById("filterHiroshi");
      const fSelect = document.getElementById("filterFruit");

      hSelect.innerHTML = '<option value="">íˆë¡œì‹œ ì „ì²´</option>';
      fSelect.innerHTML = '<option value="">ê³¼ìˆ˜ ì „ì²´</option>';

      hSet.forEach(v => hSelect.innerHTML += `<option value="${v}">${v}</option>`);
      fSet.forEach(v => fSelect.innerHTML += `<option value="${v}">${v}</option>`);
    }

    function filterData() {
      const h = document.getElementById("filterHiroshi").value;
      const f = document.getElementById("filterFruit").value;
      const tbody = document.querySelector("#dataTable tbody");
      tbody.innerHTML = "";
      let total = 0;

      dataList.forEach((item, index) => {
        if ((h && item.hiroshi !== h) || (f && item.fruit !== f)) return;
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${item.hiroshi}</td>
          <td>${item.name}</td>
          <td>${item.fruit}</td>
          <td>${item.count}</td>
          <td><button class="btn btn-danger" onclick="deleteEntry(${index})">ì‚­ì œ</button></td>
        `;
        tbody.appendChild(row);
        total += item.count;
      });

      document.getElementById("totalCount").textContent = "ì´ ê°¯ìˆ˜: " + total;
    }

    function updateGoalTable() {
      const tbody = document.querySelector("#goalTable tbody");
      tbody.innerHTML = "";

      goalList.forEach(goal => {
        const actual = dataList
          .filter(d => d.hiroshi === goal.hiroshi && d.fruit === goal.fruit)
          .reduce((sum, d) => sum + d.count, 0);
        let status = "ë¶€ì¡±";
        if (actual === goal.goal) status = "ë‹¬ì„±";
        else if (actual > goal.goal) status = "ì´ˆê³¼";

        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${goal.hiroshi}</td>
          <td>${goal.fruit}</td>
          <td>${goal.goal}</td>
          <td>${actual}</td>
          <td>${status}</td>
        `;
        tbody.appendChild(row);
      });
    }

    updateTable();
  </script>
</body>
</html>
